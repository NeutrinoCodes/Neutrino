/// @file

#ifndef color4_hpp
#define color4_hpp

  #define CL_USE_DEPRECATED_OPENCL_1_2_APIS

  #ifdef __WINDOWS__
    #define GLFW_EXPOSE_NATIVE_WIN32
    #define GLFW_EXPOSE_NATIVE_WGL
  #endif

  #ifdef __linux__
    #define GLFW_EXPOSE_NATIVE_X11
    #define GLFW_EXPOSE_NATIVE_GLX
  #endif

  //////////////////////////////////////////////////////////////////////////
  //////////////////////// Standard C header files /////////////////////////
  //////////////////////////////////////////////////////////////////////////
  #include <stdio.h>
  #include <stdlib.h>
  #include <string.h>
  #include <math.h>
  #include <errno.h>

  //////////////////////////////////////////////////////////////////////////
  ////////////////////////// Timing C header files /////////////////////////
  //////////////////////////////////////////////////////////////////////////
  #if defined(__WINDOWS__)
    #include <Windows.h>
  #elif defined(__linux__) || defined(__APPLE__)
    #include <unistd.h>
    #include <sys/resource.h>
    #include <sys/times.h>
    #include <time.h>
  #else
    #error "Unable to define getCPUTime() for an unknown OS."
  #endif

  //////////////////////////////////////////////////////////////////////////
  //////////////////////////// GLEW header files ///////////////////////////
  //////////////////////////////////////////////////////////////////////////
  #include <GL/glew.h>

  //////////////////////////////////////////////////////////////////////////
  //////////////////////////// GLFW header files ///////////////////////////
  //////////////////////////////////////////////////////////////////////////
  #include <GLFW/glfw3.h>
  #include <GLFW/glfw3native.h>

  //////////////////////////////////////////////////////////////////////////
  /////////////////////////// OpenGL header files //////////////////////////
  //////////////////////////////////////////////////////////////////////////
  #ifdef __APPLE__
    #include <OpenGL/OpenGL.h>
  #else
    #include <GL/gl.h>
  #endif

  //////////////////////////////////////////////////////////////////////////
  /////////////////////////// OpenCL header files //////////////////////////
  //////////////////////////////////////////////////////////////////////////
  #ifdef __APPLE__
    #include <OpenCL/opencl.h>
  #else
    #include <CL/cl.h>
    #include <CL/cl_gl.h>
  #endif

  #include "kernel.hpp"
  #include "queue.hpp"

  ////////////////////////////////////////////////////////////////////////////////
  ///////////////////////////////// "COLOR4" CLASS ///////////////////////////////
  ////////////////////////////////////////////////////////////////////////////////
  class color4
  {
    private:
      const char*     get_error(cl_int loc_error);
      int             err;
      unsigned int    i;
      GLfloat*        data;
      cl_context      context;                                                // OpenCL context.

    public:
      GLfloat*        r;
      GLfloat*        g;
      GLfloat*        b;
      GLfloat*        a;

      int             size;
      GLuint          vao;
      GLuint          vbo;
      cl_mem          buffer;

                      color4();
      void            init(int num_data);
      void            set(kernel* k, int kernel_arg);
      void            push(queue* q, kernel* k, int kernel_arg);
      void            pop(queue* q, kernel* k, int kernel_arg);
                      ~color4();
  };

#endif
